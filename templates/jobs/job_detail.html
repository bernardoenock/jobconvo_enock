{% extends 'base.html' %}
{% block title %}{{ job.title }}{% endblock %}
{% block content %}
<div class="container">
  <h1>{{ job.title }}</h1>
  <p><strong>Empresa:</strong> {{ job.company.name }}</p>
  <p><strong>Faixa Salarial:</strong> {{ job.get_salary_band_display }}</p>
  <p><strong>Escolaridade Mínima:</strong> {{ job.get_min_education_display }}</p>
  <p><strong>Requisitos:</strong> {{ job.requirements }}</p>

  {% if applications %}
  <h2>Candidatos</h2>
  <ul class="jobs-list">
    {% for application in applications %}
    <li>
      <strong>Email:</strong> {{ application.candidate.user.email }}<br>
      <strong>Pretensão Salarial:</strong> R$ {{ application.salary_expectation }}<br>
      <strong>Última Escolaridade:</strong> {{ application.get_candidate_last_education_display }}<br>
      <strong>Experiência:</strong> {{ application.candidate_experience }}<br>
      <strong>Pontuação:</strong> {{ application.score }}
    </li>
    {% empty %}
    <li>Ainda não há candidatos para esta vaga.</li>
    {% endfor %}
  </ul>
  {% endif %}

  {% if user.is_authenticated and user.candidate %}
  {% if not has_applied %}
  <a href="{% url 'jobs:apply' job.pk %}" class="btn">Candidatar-se</a>
  {% else %}
  <p>Você já aplicou para esta vaga ✅</p>
  {% endif %}
  {% elif not user.is_authenticated %}
  <p><a href="{% url 'accounts:login' %}">Faça login</a> como candidato para se inscrever.</p>
  {% endif %}
</div>
{% endblock %}